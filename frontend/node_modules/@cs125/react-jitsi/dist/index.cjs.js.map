{"version":3,"file":"index.cjs.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { useEffect, useState, useContext, CSSProperties } from \"react\"\nimport PropTypes from \"prop-types\"\nimport type { EventEmitter } from \"events\"\n\nexport interface JitsiOptions {\n  roomName: string\n  width?: number | string | null\n  height?: number | string | null\n  configOverwrite?: object | null\n  interfaceConfigOverwrite?: object | null\n  noSSL?: boolean | null\n  jwt?: string | null\n  onLoad?: () => void\n  invitees?: unknown[]\n  devices?: {\n    audioInput?: string\n    audioOutput?: string\n    videoInput?: string\n  }\n  userInfo?: {\n    email?: string\n    displayName?: string\n  }\n}\nexport declare class JitsiMeetExternalAPI extends EventEmitter {\n  constructor(domain: string, options?: JitsiOptions & { parentNode: Element })\n  dispose: () => void\n  executeCommand: (command: string, ...args: string[]) => void\n  getNumberOfParticipants: () => number\n  avatarURL: () => string\n  displayName: () => string\n  email: () => string\n  iframe: () => HTMLIFrameElement\n  isAudioMuted: () => Promise<boolean>\n  isVideoMuted: () => Promise<boolean>\n  isAudioAvailable: () => Promise<boolean>\n  isVideoAvailable: () => Promise<boolean>\n  invite: (invitees: unknown[]) => Promise<void>\n}\n\nexport interface JitsiWrapperContext {\n  loaded: boolean\n  url: string\n}\nconst JitsiWrapperContext = React.createContext<JitsiWrapperContext>({\n  loaded: false,\n  url: \"\",\n})\nexport interface JitsiWrapperProps {\n  url: string\n  children: React.ReactNode\n}\nexport const JitsiWrapper: React.FC<JitsiWrapperProps> = ({ url, children }) => {\n  const [loaded, setLoaded] = useState<boolean>(false)\n\n  useEffect(() => {\n    const script = Object.assign(document.createElement(\"script\"), {\n      src: `${url}/external_api.js`,\n      async: true,\n      defer: true,\n    })\n    script.onload = (): void => {\n      setLoaded(true)\n    }\n    document.head.appendChild(script)\n    return (): void => {\n      document.head.removeChild(script)\n    }\n  }, [])\n\n  return <JitsiWrapperContext.Provider value={{ loaded, url }}>{children}</JitsiWrapperContext.Provider>\n}\nJitsiWrapper.propTypes = {\n  url: PropTypes.string.isRequired,\n  children: PropTypes.node.isRequired,\n}\n\nexport const withJitsiContext = (): JitsiWrapperContext => {\n  return useContext(JitsiWrapperContext)\n}\ninterface WithJitsiContextProps {\n  children: (jitsiContext: JitsiWrapperContext) => JSX.Element | null\n}\nexport const WithJitsiContext: React.FC<WithJitsiContextProps> = ({ children }) => {\n  return children(withJitsiContext())\n}\nWithJitsiContext.propTypes = {\n  children: PropTypes.func.isRequired,\n}\n\nexport interface JitsiRoomProps {\n  domain: string\n  options: JitsiOptions\n  id?: string\n  style?: CSSProperties\n  apiChanged?: (api: JitsiMeetExternalAPI) => void\n}\nexport const jitsiOptionDefaults = {\n  width: \"100%\",\n  height: \"100%\",\n  noSSL: true,\n}\nexport const JitsiRoom: React.FC<JitsiRoomProps> = (props) => {\n  const { loaded } = useContext(JitsiWrapperContext)\n\n  const { domain } = props\n  const options = Object.assign({}, jitsiOptionDefaults, props.options)\n\n  const id = props.id || \"jitsi\"\n  let api: JitsiMeetExternalAPI | undefined\n\n  useEffect(() => {\n    if (!loaded) {\n      return\n    }\n    api = new JitsiMeetExternalAPI(domain, {\n      parentNode: document.querySelector(`#${id}`) as Element,\n      ...options,\n    })\n    props.apiChanged && props.apiChanged(api)\n    return (): void => {\n      api?.dispose()\n    }\n  }, [loaded, JSON.stringify({ domain, options })])\n\n  return <div id={id || \"jitsi\"} style={props.style || {}} />\n}\n\nJitsiRoom.propTypes = {\n  domain: PropTypes.string.isRequired,\n  options: PropTypes.shape({\n    roomName: PropTypes.string.isRequired,\n    width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    configOverwrite: PropTypes.object,\n    interfaceConfigOverwrite: PropTypes.object,\n    noSSL: PropTypes.bool,\n    jwt: PropTypes.string,\n  }).isRequired,\n  id: PropTypes.string,\n  style: PropTypes.object,\n  apiChanged: PropTypes.func,\n}\n"],"names":["React","useState","useEffect","useContext"],"mappings":"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"}